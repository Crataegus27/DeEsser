cmake_minimum_required(VERSION 3.0.0)
project(DeEsser)

set(CMAKE_CXX_STANDARD 17)

# libsoundio options
set(BUILD_EXAMPLE_PROGRAMS OFF CACHE BOOL "Build example programs")
set(BUILD_TESTS OFF CACHE BOOL "Build tests")
set(BUILD_DYNAMIC_LIBS OFF CACHE BOOL "Build dynamic libs" FORCE)
set(BUILD_STATIC_LIBS ON CACHE BOOL "Build static libs" FORCE)
set(NANOGUI_BUILD_SHARED OFF CACHE BOOL " " FORCE)
set(BUILD_SHARED_LIBS OFF CACHE BOOL " " FORCE)

add_subdirectory(src/)
add_subdirectory(lib/fmt)
add_subdirectory(lib/nanogui)
add_subdirectory(lib/libsoundio)

add_executable(DeEsser ${SOURCES})

include_directories(
    ${CMAKE_CURRENT_SOURCE_DIR}/lib/
    ${CMAKE_CURRENT_SOURCE_DIR}/lib/libsoundio/
    ${CMAKE_CURRENT_SOURCE_DIR}/lib/nanogui/include/
    ${NANOGUI_EXTRA_INCS}
)

get_directory_property(LIBSOUNDIO_LIBS DIRECTORY lib/libsoundio DEFINITION LIBSOUNDIO_LIBS)
set_property(TARGET glfw glfw_objects nanogui PROPERTY FOLDER "dependencies")

# Various preprocessor definitions have been generated by NanoGUI
add_definitions(${NANOGUI_EXTRA_DEFS})

if(BUILD_STATIC_LIBS)
    add_compile_definitions(SOUNDIO_STATIC_LIBRARY)
endif()

target_link_libraries(DeEsser
    libsoundio_static
    nanogui
    fmt::fmt
    ${LIBSOUNDIO_LIBS}
    ${NANOGUI_EXTRA_LIBS}
)